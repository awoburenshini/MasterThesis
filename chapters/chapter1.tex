
\chapter{绪论}
\label{chap_int}
\section{问题背景}
计算机模拟几乎在所有的工程领域都是一个重要工具，从土木工程、地球物理、生物医学工程这些大型工程领域，到服装设计、家具设计这些生活周边，再到
游戏行业，电影特效这些文化领域处处都有计算机模拟的身影。计算机模拟不单单只为解决一些极其复杂难以实验，难以分析的问题，它同时也在替代一些昂贵耗时的物理实验，
给设计人员一些基础的直观信息。

目前主要的物理模拟方法以及一些商业化的工业模拟算法都是在有限元~\cite{1942Variational}的框架下实现的。尽管有限元方法已经理论成熟，并且早已经在学术界和工业界广泛的使用，
但是当用来求解一些大形变问题，拓扑变化问题时有限元便显得捉襟见肘，虽然这些问题可以使用重新网格化或者自适应网格来解决，但是网格处理本身就是一个极其复杂的问题，由此带来的便是
算法的鲁棒性问题，以及算法的性能也会大打折扣。

在电影特效行业以及游戏行业，经常遇到的问题便是大形变以及多物理场耦合问题，这也导致传统的有限元方法难以应对。然而，电影特效与游戏行业本身对模拟精度的要求并不是那么高，对于这些
对精度没有太高要求的问题，人们转而不再单纯的使用网格来表示物体，更灵活的粒子表示方法进入了学者们的视野。近年来，在电影特效界，首当其冲粒子表示方法的便是物质点法，该方法很大程度
解决了有限元大形变以及拓扑变化难的缺点，同时由于其加入了空间背景网格参与求解，使其对物理场建模有着极大的灵活性，在应对复杂多样的物理现象时，常常可以使用物质点法作为切入点。但是，
在流体模拟中，物质点法相对于专门为流体计算设计的方法并不完善，效果也相差甚远，如流体粘性，表面张力等效应都没有得到很好的表现，而这也使得多物理场模拟在涉及流体的时候，物质点法往往并不能
很准确的表现出流体的特性，或给人以明显的不真实感。
\section{相关工作}
\subsection{物质点法}
Walt Disney工作室在2013年成功对雪的模拟~\cite{stomakhin2013material}将物质点法带到了图形学领域，同时在《冰雪奇缘》这部电影中大放异彩。此时的物质点法在图形学领域还仅仅是用于
模拟沙泥这类粘状的物质，但是其方便多物理场耦合的特性已经吸引了众多学者的注意，从Ram模拟粘性的牙膏、海绵、泡沫~\cite{2015foams}这类符合物质点法特性的材料，到Chengfanfu等人提出了APIC,在物质点法中加入仿射项~\cite{jiang2015affine}改进物质点法，
使其能够模拟粘性较低的流体，再到Gergely等人改进塑性的屈服模型~\cite{klar2016drucker}，沙粒模拟也加入到物质点法能够模拟的范畴。之后Wang将有限元与物质点法相结合，让弹性体~\cite{2019WangDuctile}能够方便的
实现破碎效果，同时改进物质点法本身的数值粘性带来的碰撞不真实感。在有了这么多的针对单种物质模拟的基础工作之后，人们开始着手于多物理场，如在2017年Tampubolu等人的~\cite{tampubolon2017multi}对水和沙子耦合的模拟，Chengfanfu等人对布料沙子以及头发
织物~\cite{jiang2017anisotropic}的模拟，这些复杂的场景带来了惊人的视觉效果。在2019年，物质点法开始向着“生活”迈进，Mengyuan等人~\cite{Ding2019}首先将热转换、弹塑性、气体压强、流体压强、流体蒸发这些现象耦合在一起，成功的在计算机中模拟了烤曲奇饼干、烤面包、夹心面包、
水果风干等效果，展现出物质点法框架巨大的包容性。除了发掘物质点法优势之外，也有学者在改进物质点法本身的劣势，比如物质点法模拟流体时，经常表现出数值粘性，给人一种胶水质感。ChuYuan等~\cite{fu2017polynomial}人针对流体所展现的粘性，继续改进物质点法的粒子网格对流过程，
通过推广APIC算法，使物质点法下的流体展现出更多细节，同时更好的保留速度信息，大大的降低了流体本身的粘性。Yu等人~\cite{fang2020iq}针对物质点法流体和固体耦合时，由固体表面计算时带来的数值粘性做出了改进，成功的解决了流体流过固体表面出现粘连的问题。

\subsection{流体表面张力模拟}
流体表面张力存在于两种混溶的流体或在固体和气体的相交面上，其大小正比于接触面的曲率。通常我们在模拟大规模的流体时，表面张力相比于其他力来说对流体运动影响极小，因此人们经常不考虑表面张力，此时人们经常称这种流体为无表面流体。然而在小尺度流体模拟时，
表面积体积比足够大，那么表面张力带来的影响将不可忽视。

尽管物质点法在弹性体，多物理场，无表面流体模拟都取得了很大进展，但是其针对流体表面张力并没有很多工作，最早尝试往物质点法添加表面张力是2012年的由L.Chen等人~\cite{chen2012modeling}提出的的广义插值物质点法(GIMP)，他们使用连续体表面(CSF)对表面张力建模，
通过空间的质量梯度来计算表面张力。然而，物质点法的空间质量分布非常粗糙，在他们的实验结果中，存在较大的不真实感。之后便是2020年的David等人~\cite{hyde2020implicit}，他们认为直接使用辛格式积分需要很小的时间步长才能保证系统的稳定，于是使用隐式法来耦合
表面张力与流体内部压强。然而物质点法每一帧的控制网格都有所差别，于是隐式法每一帧都有重建一个较大的稀疏矩阵的要求，且难以预判该稀疏矩阵的格式，这也给性能提升带来了巨大的挑战。

当然，在非物质点法上，有许多针对流体表面张力设计的算法。在图形学领域，Akinci等人~\cite{akinci2013versatile}改进SPH算法，在模拟稳定态的表面张力取得了很好的效果。Wang等人~\cite{wang2005water}直接计算流体与固体的接触角，在模拟最后的接触结果时，能够达到逼真的效果。
在2020年，Hui等人~\cite{wang2020codimensional}通过检测表面粒子，然后在每一个表面粒子局部的重建二次曲面，用于计算每个表面粒子上的表面张力，这种方法很好的捕捉了表面张力的各种效果，然而其计算代价也是高昂的，同时Hui在文章中也提到，文章中使用的探测一个粒子是否是表面粒子的算法并不鲁棒，可能
会引发一些意想不到的问题，同时对于检测粒子是否是表面粒子本身就是一件困难的事情，Marcos等人~\cite{sandim2016boundary}在2016年对探测表面粒子这件事情有着一些讨论。除了使用粒子法，也有学者直接使用网格法来模拟流体，在2016年，Fang等人~\cite{da2016surface}提出使用边界元的方法来模拟流体，这样的
求解策略假定了流体内部的速度场是无旋无散，当然在单纯的模拟小尺度的流体时，如此假定是合适的。这种方法也在2020年由Huang等人~\cite{huang2020surface}再次使用用来模拟磁流体，该工作做出了许多非常逼真炫酷的效果。在计算数学领域，学者们针对流体表面张力项提出求解策略，2020年Takuya等人~\cite{matsunaga2020moving}使用
表面网格和内部粒子来描述水滴，通过表面网格计算表面张力同时通过内部粒子计算流体压强并将其耦合，并通过不断调整网格顶点位置来改善网格质量，以此提高表面张力计算的准确性，然而调整网格质量也给网格拓扑变化以及大变形带来了麻烦，Huang等人也在文章中说明该方法并未考虑水滴的拓扑变化。当然，也有学者将流体表面张力单独提取出来计算，
实际上流体表面张力对应了一个曲面上的拉普拉斯贝尔特拉米算子~\cite{needham2021visual}，当前学者们针对点云表示的曲面构造对应的离散算子。在2013年，Rongjie等人~\cite{lai2013local}提出在每一点局部的重建Delauney网格来构造拉普拉斯算子，Diego等人~\cite{alvarez2021local}使用局部径向基函数方法构造，Liang等人~\cite{liang2013solving}
提出局部构造二次曲面以及使用二次拟合的策略来构造。当然，由于以上算子构造方式都是以局部的方式给出，这也损失了拉普拉斯方程的对称性。
\subsection{表面重构} 
从前文中可以发现，为了计算表面张力，我们需要给出流体的表面表示，而为了在粒子表示的流体上计算表面张力，我们便需要定义出粒子表示流体的表面。在三维重建的领域，学者们已经针对表面重构做了许多的工作。表面重建分成两种思路，第一种是显式曲面重建，显式重建可以直接处理没有附加信息的点云，其思路主要是基于Delauney三角化理论。
Amenta等人~\cite{amenta1998new}在1998年结合三维Voronui图和Delauney三角刨分提出三维的Crust算法，他们在2001年对其改进提出Power Crust算法，其借鉴了$\alpha$形的思想，使用加权Voronoi图改进，提高了对尖锐特征以及高噪声点云的处理能力。这类显式重建方法都涉及到Delauney三角刨分，需要较大的计算开销。另一类算法则是使用隐式曲面
来拟合点云，大多数隐式曲面重建算法都与Blinn于1982年~\cite{blinn1982generalization}的思想相似，他们都使用局部基函数来重构隐式曲面。在1991年，Muraki等人~\cite{muraki1991volumetric}提出使用Blobby建模方法，这也是一种类似径向基函数的做法。Hoppe等人在1992年~\cite{hoppe1992surface}提出使用局部符号距离场来重构隐式曲面。
Carr~\cite{carr2001reconstruction}同样使用局部径向基函数，结合优化技巧给出了一种快速计算的流程。2019年，Huang等人~\cite{huang2019variational}提出变分隐式曲面法，该方法对稀疏非均匀点集有着较好的效果与计算性能。

由于点云数据一般非常庞大，因此在构造隐式曲面时，所对应的优化问题都有着非常庞大的规模，如此构造的求解矩阵也是非常庞大的。为了降低内存消耗，Morse等人~\cite{morse2005interpolating}使用局部紧的径向基函数插值方式，大大减少了计算代价与内存消耗。同样，为了降低内存消耗，Jun等人在2016年~\cite{wang2010adaptive}使用自适应八叉树T样条
来进一步降低内存消耗。Yusuf等人~\cite{hamza2020implicit}在2020年结合步进迭代逼近与局部紧支撑基函数，进一步加快了求解速度。
\section{研究内容}
本文主要研究了如何在物质点法框架下计算表面张力，并提出了一个快速曲面重构算法。过去有许多针对表面张力模拟的算法，但也是由于其针对性，尽管对于表面张力模拟效果较好，但是难以在该框架下求解其他现象，导致其应用的局限性。同时近年来的也开始发展出许多普适的模拟算法，比如改进的SPH，尽管其本身就是从流体算法发展而来，但是其对表面张力的
模拟并没有很好的支持。同时近年来一个针对SPH改进的算法，被称为移动最小二乘再生核算法~\cite{chen2020moving}，不过该方法也没有考虑表面张力，只是将弹性体纳入求解框架。另一个方法便是近期火热的物质点法，尽管物质点法已经能够模拟很多现象，且已经能够轻易的将许多物理方程耦合求解，使其都容纳到一个框架之下，极大的展现了它的普适性,
但是其对于流体，特别是流体表面张力研究甚少。本文便从物质点法出发，改进物质点法计算流程，将流体表面张力模拟也融合进物质点法的求解框架之中。

在解决物质点法模拟表面张力的过程中，本文还基于Yusuf等人的步进迭代逼近~\cite{hamza2020implicit}，改进了隐式曲面拟合算法，让整个算法有更高的并行效率，同时有更好的收敛性，使其相较原有算法至少达到三个数量级的加速，同时大大降低内存消耗。特别的，我们发现该隐式曲面拟合算法的计算流程与物质点法部分的计算流程极其类似，这也启发我们利用物质点法的数据结构
来计算隐式曲面，经过分析，该计算过程不会带来额外的内存消耗。

在计算表面张力时，为了获取隐式曲面的法向，我们提出了一个更高效的法向逼近算法，该算法相较于直接计算函数梯度有着更低的复杂度，同时更易于底层并行。

在耦合物质点法的内部压强和表面张力之时，我们还给出了一个提高数值稳定性的技巧，即将表面粒子嵌入到内部粒子，这样可以更直接的将表面张力传导到内部粒子与之耦合，相较于直接通过背景网格耦合两者，嵌入内部粒子的方法提高了计算的稳定性。

本文的主要工作总结如下:

(一)改进了一个新的点云拟合隐式曲面的算法，同时提出一个相应的快速法向计算方法，并将相应算法耦合进物质点法框架中。

(二)给出了物质点法模拟表面张力的计算流水线，并给出了相应的数值离散形式，同时在实现上使用嵌入内部粒子技巧提高了数值稳定性。

本文的章节内容安排如下：

    第一章，绪论，主要介绍了物理模拟的背景以及近期有关物质点法，表面张力，表面重构三方面的相关工作，同时引出文章需要解决的问题。最后总结了文章的研究内容以及文章结构。

    第二章，连续介质力学，给出了文章所需要的基本理论，从欧拉视角和拉格朗日视角来描述我们求解的问题，以此对应物质点法中的网格法与粒子法两个部分，给出了方程离散的基础。同时给出了表面张力的形式，这部分内容也引导了我们在物质点法中如何计算表面张力。

    第三章，表面重建，主要给出了如何构造一个粒子表示的流体表面。同时给出我们的隐式曲面拟合算法，并与之前的文章进行性能对比试验来说明我们方法的优势。最后介绍了快速法向计算方法，在理论上分析了快速法向算法能够提高直接梯度计算的性能。

    第四章，数值方法，主要介绍了如何将第一章给出的连续控制方程离散化，同时给出了嵌入粒子法以及一些工程修正方法，保证求解方程的稳定性。最后将第三章的表面重建方法耦合到物质点法中，总结出对应的计算流水线以及展示相应的实验结果。

    第五章，总结与展望，给出了本文存在的局限性，以及提出相应的问题以及进一步研究的方向。
\section{本章小结}
本章首先介绍了物理模拟在各种场景的应用以及存在的问题，之后介绍了前人在物质点法、表面张力模拟、表面重建三个方面的工作，并由此引出本文所解决的问题。之后阐明了并总结了本文的研究内容，并给出了各章内容的概要。
